
rajesh@ubuntu:~/Embedur_Linux_Learning_Programme/module_03$ cat backup_manager.sh 
#!/bin/bash

# 1. Arguments
SOURCE="$1"
BACKUP="$2"
EXT="$3"

if [ $# -ne 3 ]; then
    echo "Usage: $0 SOURCE_DIR BACKUP_DIR EXT"
fi

# 2. Check source directory
if [ ! -d "$SOURCE" ]; then
    echo "Source directory does not exist"
fi

# 3. Create backup directory if not present
if [ ! -d "$BACKUP" ]; then
    mkdir "$BACKUP"
    if [ $? -ne 0 ]; then
        echo "Cannot create backup directory"
    fi
fi

# 4. Globbing + array
files=( "$SOURCE"/*"$EXT" )

# 5. If no files
if [ ${#files[@]} -eq 0 ]; then
    echo "No matching files found"
fi

# 6. Export count
export BACKUP_COUNT=0

total_size=0
total_processed=0

echo "Files to be backed up:"

# 7. Print file names and sizes
for f in "${files[@]}"
do
    size=$(wc -c < "$f")
    echo "$(basename "$f")  $size bytes"
done

# 8. Backup loop
for f in "${files[@]}"
do
    total_processed=$((total_processed + 1))

    name=$(basename "$f")
    dest="$BACKUP/$name"

    if [ ! -f "$dest" ]; then
        cp "$f" "$dest"
        BACKUP_COUNT=$((BACKUP_COUNT + 1))
        size=$(wc -c < "$f")
        total_size=$((total_size + size))

    else
        if [ "$f" -nt "$dest" ]; then
            cp "$f" "$dest"
            BACKUP_COUNT=$((BACKUP_COUNT + 1))
            size=$(wc -c < "$f")
            total_size=$((total_size + size))
        fi
    fi
done

# 9. Report
report="$BACKUP/backup_report.log"

echo "Backup Report" > "$report"
echo "Files processed : $total_processed" >> "$report"
echo "Files backed up : $BACKUP_COUNT" >> "$report"
echo "Total size      : $total_size bytes" >> "$report"
echo "Backup folder   : $BACKUP" >> "$report"

echo "Done."
echo "Report saved in $report"


rajesh@ubuntu:~/Embedur_Linux_Learning_Programme/module_03$ ./backup_manager.sh ./test_source ./test_backup .txt
Files to be backed up:
notes.txt  65 bytes
report-a.txt  15 bytes
sample.txt  9 bytes
todo.txt  23 bytes
Done.
Report saved in ./test_backup/backup_report.log
rajesh@ubuntu:~/Embedur_Linux_Learning_Programme/module_03$ cd test_backup/
rajesh@ubuntu:~/Embedur_Linux_Learning_Programme/module_03/test_backup$ cat backup_report.log 
Backup Report
Files processed : 4
Files backed up : 2
Total size      : 32 bytes
Backup folder   : ./test_backup
